<!DOCTYPE html>
<html xml:lang="EN" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>Wimmelbild - Plan:g</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="icon" type="image/png" href="favicon.png" />

    <!-- OpenSeadragon -->
    <script src="./openseadragon/openseadragon.min.js"></script>
    <!-- Browser-Detect (optional) -->
    <script src="detect-browser.js"></script>
    <script>
      const info = (typeof getBrowser === "function" && getBrowser()) || {};
      // if (["Microsoft Edge","Safari","Internet Explorer"].includes(info.browser)) {
      //   window.location = "index_ie.html";
      // }
      const IS_TOUCH = matchMedia("(pointer:coarse)").matches;
    </script>

    <style>
      @font-face { font-family:"circular"; src:url("src/lineto-circular-book.woff") format("woff"); font-weight:normal; }
      *{margin:0;padding:0;box-sizing:border-box}
      html,body{height:100%}
      body{font-family:"circular",Arial,sans-serif;background:#f3f3f3;overflow:hidden}

      .logo-container{
        position:absolute;z-index:1000;top:25px;left:25px;
        opacity:0;display:none;transition:opacity .3s;
      }
      .logo{width:250px;padding-bottom:30px}
      .signet{width:100px}

      /* Viewer Startzustand (Kreis) */
      #myContainer{
        position:absolute; width:100%; height:100vh; left:10vw;
        background:#769b60; z-index:500; overflow:hidden;
        clip-path:circle(20vw at center); -webkit-clip-path:circle(20vw at center);
        transition:clip-path .5s,left .5s;
      }

      /* Vollbildzustand per Klasse */
      #myContainer.viewer-open{
        position:fixed; inset:0; left:0 !important; width:100vw;height:100vh;
        clip-path:circle(100vw at 50% 50%); -webkit-clip-path:circle(100vw at 50% 50%);
        z-index:1200;
      }

      .viewer-scrim{position:fixed;inset:0;background:rgba(0,0,0,.35);opacity:0;pointer-events:none;transition:opacity .25s;z-index:1190}
      .viewer-scrim.show{opacity:1;pointer-events:auto}
      .viewer-close{position:fixed;top:12px;right:12px;z-index:1300;width:40px;height:40px;border:0;border-radius:999px;background:rgba(0,0,0,.55);color:#fff;font-size:22px;line-height:40px;text-align:center;cursor:pointer;opacity:0;pointer-events:none;transition:opacity .2s}
      .viewer-close.show{opacity:1;pointer-events:auto}

      .welcome{position:absolute;z-index:250;top:51px;left:22px;width:70%}
      .welcomeMessage{margin-top:20px}
      .flexcta{width:60%;padding-top:60px}
      .cta{max-width:230px;background:#789f40;padding:15px;color:#fff;text-decoration:none;display:flex;align-items:center;justify-content:center;text-transform:uppercase;font-weight:bold;font-size:18px;transition:background-color .25s;margin:20px 0 0 0}
      .cta:hover{background:#870184}

      .impressum{position:absolute;bottom:20px;left:22px;z-index:260;font-size:18px;line-height:1.5}
      .text-link{color:#789f40;text-decoration:none}
      .language{display:flex;width:80px;height:50px;justify-content:space-between;font-size:14px}
      .flag{width:30px;height:22px;background-size:cover;margin:10px auto}
      .flag.en{background-image:url("https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/flags/4x3/gb.svg")}
      .flag.de{background-image:url("https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/flags/4x3/at.svg")}

      /* 🔴 Hotspots – jetzt größer */
      .hotspot-overlay{
        width:26px;         /* vorher 14px */
        height:26px;
        border-radius:50%;
        background-size:cover;background-repeat:no-repeat;
        box-shadow:0 2px 4px rgba(0,0,0,.3);
        /* transform wird dynamisch gesetzt, wenn KEEP_CONSTANT_SIZE = true */
        will-change: transform;
      }

      .popup img{display:block;max-width:90vw;height:auto}
    </style>

    <!-- Matomo -->
    <script>
      var _paq = window._paq || [];
      _paq.push(["trackPageView"]); _paq.push(["enableLinkTracking"]);
      (function(){var u="https://www.plan-g.at/sub/piwik/";_paq.push(["setTrackerUrl",u+"piwik.php"]);_paq.push(["setSiteId","4"]);var d=document,g=d.createElement("script"),s=d.getElementsByTagName("script")[0];g.async=true;g.defer=true;g.src=u+"piwik.js";s.parentNode.insertBefore(g,s);})();
    </script>
  </head>
  <body>
    <!-- Scrim & Close für Vollbild -->
    <div id="viewerScrim" class="viewer-scrim" aria-hidden="true"></div>
    <button id="viewerClose" class="viewer-close" aria-label="Schließen">✕</button>

    <div id="myContainer"></div>

    <script>
      /* ===== OpenSeadragon ===== */
      const viewer = OpenSeadragon({
        id: "myContainer",
        prefixUrl: "openseadragon/images/",
        tileSources: {
          type: "image",
          width: 5787,
          height: 7722,
          url: "./img/wimmelbildfinal.jpg",
          minLevel: 0,
          maxLevel: 5,
          buildPyramid: true
        },
        // UI reduziert für Touch
        showNavigator: !IS_TOUCH,
        navigatorPosition: "TOP_RIGHT",
        showNavigationControl: !IS_TOUCH,
        defaultZoomLevel: 0,
        gestureSettingsMouse: { clickToZoom:true, dblClickToZoom:true, pinchToZoom:true, flickEnabled:true },
        gestureSettingsTouch: { clickToZoom:true, dblClickToZoom:true, pinchToZoom:true, flickEnabled:true },
        constrainDuringPan: true,
        maxZoomPixelRatio: 2,
        minZoomImageRatio: 0.5,
        maxZoomImageRatio: 3,
        visibilityRatio: 0.9
      });

      let HOME_Z = 1;
      const KEEP_CONSTANT_SIZE = true; // ⇐ auf false setzen, wenn Punkte mitzoomen sollen

      viewer.addHandler('open', () => {
        viewer.viewport.fitVertically();
        HOME_Z = viewer.viewport.getZoom(tru_
